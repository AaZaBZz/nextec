SQL> select employee_id, last_name
  2  from employees
  3  where employee_id <>any
  4  (select manager_id from employees);

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        174 Abel                                                                
        166 Ande                                                                
        130 Atkinson                                                            
        105 Austin                                                              
        204 Baer                                                                
        116 Baida                                                               
        167 Banda                                                               
        172 Bates                                                               
        192 Bell                                                                
        151 Bernstein                                                           
        129 Bissot                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        169 Bloom                                                               
        185 Bull                                                                
        187 Cabrio                                                              
        148 Cambrault                                                           
        154 Cambrault                                                           
        110 Chen                                                                
        188 Chung                                                               
        119 Colmenares                                                          
        142 Davies                                                              
        102 De Haan                                                             
        186 Dellinger                                                           

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        189 Dilly                                                               
        160 Doran                                                               
        104 Ernst                                                               
        147 Errazuriz                                                           
        193 Everett                                                             
        109 Faviet                                                              
        202 Fay                                                                 
        197 Feeney                                                              
        181 Fleaur                                                              
        170 Fox                                                                 
        121 Fripp                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        190 Gates                                                               
        135 Gee                                                                 
        183 Geoni                                                               
        206 Gietz                                                               
        199 Grant                                                               
        178 Grant                                                               
        108 Greenberg                                                           
        163 Greene                                                              
        152 Hall                                                                
        201 Hartstein                                                           
        205 Higgins                                                             

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        118 Himuro                                                              
        103 Hunold                                                              
        175 Hutton                                                              
        179 Johnson                                                             
        195 Jones                                                               
        122 Kaufling                                                            
        115 Khoo                                                                
        156 King                                                                
        100 King                                                                
        101 Kochhar                                                             
        173 Kumar                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        137 Ladwig                                                              
        127 Landry                                                              
        165 Lee                                                                 
        177 Livingston                                                          
        107 Lorentz                                                             
        133 Mallin                                                              
        128 Markle                                                              
        131 Marlow                                                              
        164 Marvins                                                             
        143 Matos                                                               
        203 Mavris                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        194 McCain                                                              
        158 McEwen                                                              
        126 Mikkilineni                                                         
        124 Mourgos                                                             
        125 Nayer                                                               
        198 OConnell                                                            
        153 Olsen                                                               
        132 Olson                                                               
        168 Ozer                                                                
        146 Partners                                                            
        106 Pataballa                                                           

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        140 Patel                                                               
        191 Perkins                                                             
        136 Philtanker                                                          
        113 Popp                                                                
        141 Rajs                                                                
        114 Raphaely                                                            
        134 Rogers                                                              
        145 Russell                                                             
        184 Sarchand                                                            
        111 Sciarra                                                             
        139 Seo                                                                 

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        161 Sewall                                                              
        159 Smith                                                               
        171 Smith                                                               
        138 Stiles                                                              
        182 Sullivan                                                            
        157 Sully                                                               
        176 Taylor                                                              
        180 Taylor                                                              
        117 Tobias                                                              
        150 Tucker                                                              
        155 Tuvault                                                             

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        112 Urman                                                               
        144 Vargas                                                              
        162 Vishney                                                             
        123 Vollman                                                             
        196 Walsh                                                               
        120 Weiss                                                               
        200 Whalen                                                              
        149 Zlotkey                                                             

107 rows selected.

SQL> select employee_id, last_name
  2  from employees
  3  where employee_id in
  4  (select manager_id from employees);

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        148 Cambrault                                                           
        102 De Haan                                                             
        147 Errazuriz                                                           
        121 Fripp                                                               
        108 Greenberg                                                           
        201 Hartstein                                                           
        205 Higgins                                                             
        103 Hunold                                                              
        122 Kaufling                                                            
        100 King                                                                
        101 Kochhar                                                             

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        124 Mourgos                                                             
        146 Partners                                                            
        114 Raphaely                                                            
        145 Russell                                                             
        123 Vollman                                                             
        120 Weiss                                                               
        149 Zlotkey                                                             

18 rows selected.

SQL> select employee_id, last_name
  2  from employees
  3  where employee_id not in
  4  (select manager_id from employees where manager_id is not null);

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        174 Abel                                                                
        166 Ande                                                                
        130 Atkinson                                                            
        105 Austin                                                              
        204 Baer                                                                
        116 Baida                                                               
        167 Banda                                                               
        172 Bates                                                               
        192 Bell                                                                
        151 Bernstein                                                           
        129 Bissot                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        169 Bloom                                                               
        185 Bull                                                                
        187 Cabrio                                                              
        154 Cambrault                                                           
        110 Chen                                                                
        188 Chung                                                               
        119 Colmenares                                                          
        142 Davies                                                              
        186 Dellinger                                                           
        189 Dilly                                                               
        160 Doran                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        104 Ernst                                                               
        193 Everett                                                             
        109 Faviet                                                              
        202 Fay                                                                 
        197 Feeney                                                              
        181 Fleaur                                                              
        170 Fox                                                                 
        190 Gates                                                               
        135 Gee                                                                 
        183 Geoni                                                               
        206 Gietz                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        199 Grant                                                               
        178 Grant                                                               
        163 Greene                                                              
        152 Hall                                                                
        118 Himuro                                                              
        175 Hutton                                                              
        179 Johnson                                                             
        195 Jones                                                               
        115 Khoo                                                                
        156 King                                                                
        173 Kumar                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        137 Ladwig                                                              
        127 Landry                                                              
        165 Lee                                                                 
        177 Livingston                                                          
        107 Lorentz                                                             
        133 Mallin                                                              
        128 Markle                                                              
        131 Marlow                                                              
        164 Marvins                                                             
        143 Matos                                                               
        203 Mavris                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        194 McCain                                                              
        158 McEwen                                                              
        126 Mikkilineni                                                         
        125 Nayer                                                               
        198 OConnell                                                            
        153 Olsen                                                               
        132 Olson                                                               
        168 Ozer                                                                
        106 Pataballa                                                           
        140 Patel                                                               
        191 Perkins                                                             

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        136 Philtanker                                                          
        113 Popp                                                                
        141 Rajs                                                                
        134 Rogers                                                              
        184 Sarchand                                                            
        111 Sciarra                                                             
        139 Seo                                                                 
        161 Sewall                                                              
        159 Smith                                                               
        171 Smith                                                               
        138 Stiles                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        182 Sullivan                                                            
        157 Sully                                                               
        176 Taylor                                                              
        180 Taylor                                                              
        117 Tobias                                                              
        150 Tucker                                                              
        155 Tuvault                                                             
        112 Urman                                                               
        144 Vargas                                                              
        162 Vishney                                                             
        196 Walsh                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        200 Whalen                                                              

89 rows selected.

SQL> select  last_name , hire_date
  2  from employees
  3  where department_id = (select department_id from employees where last_name='Smith');
where department_id = (select department_id from employees where last_name='Smith')
                       *
ERROR at line 3:
ORA-01427: single-row subquery returns more than one row 


SQL> select  last_name , hire_date
  2  from employees
  3  where department_id in (select department_id from employees where last_name='Smith');

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
Russell                   01-OCT-04                                             
Partners                  05-JAN-05                                             
Errazuriz                 10-MAR-05                                             
Cambrault                 15-OCT-07                                             
Zlotkey                   29-JAN-08                                             
Tucker                    30-JAN-05                                             
Bernstein                 24-MAR-05                                             
Hall                      20-AUG-05                                             
Olsen                     30-MAR-06                                             
Cambrault                 09-DEC-06                                             
Tuvault                   23-NOV-07                                             

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
King                      30-JAN-04                                             
Sully                     04-MAR-04                                             
McEwen                    01-AUG-04                                             
Smith                     10-MAR-05                                             
Doran                     15-DEC-05                                             
Sewall                    03-NOV-06                                             
Vishney                   11-NOV-05                                             
Greene                    19-MAR-07                                             
Marvins                   24-JAN-08                                             
Lee                       23-FEB-08                                             
Ande                      24-MAR-08                                             

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
Banda                     21-APR-08                                             
Ozer                      11-MAR-05                                             
Bloom                     23-MAR-06                                             
Fox                       24-JAN-06                                             
Smith                     23-FEB-07                                             
Bates                     24-MAR-07                                             
Kumar                     21-APR-08                                             
Abel                      11-MAY-04                                             
Hutton                    19-MAR-05                                             
Taylor                    24-MAR-06                                             
Livingston                23-APR-06                                             

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
Johnson                   04-JAN-08                                             

34 rows selected.

SQL> select  last_name , hire_date
  2  from employees
  3  where last_name!='Smith' and department_id in (select department_id from employees where last_name='Smith');

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
Russell                   01-OCT-04                                             
Partners                  05-JAN-05                                             
Errazuriz                 10-MAR-05                                             
Cambrault                 15-OCT-07                                             
Zlotkey                   29-JAN-08                                             
Tucker                    30-JAN-05                                             
Bernstein                 24-MAR-05                                             
Hall                      20-AUG-05                                             
Olsen                     30-MAR-06                                             
Cambrault                 09-DEC-06                                             
Tuvault                   23-NOV-07                                             

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
King                      30-JAN-04                                             
Sully                     04-MAR-04                                             
McEwen                    01-AUG-04                                             
Doran                     15-DEC-05                                             
Sewall                    03-NOV-06                                             
Vishney                   11-NOV-05                                             
Greene                    19-MAR-07                                             
Marvins                   24-JAN-08                                             
Lee                       23-FEB-08                                             
Ande                      24-MAR-08                                             
Banda                     21-APR-08                                             

LAST_NAME                 HIRE_DATE                                             
------------------------- ---------                                             
Ozer                      11-MAR-05                                             
Bloom                     23-MAR-06                                             
Fox                       24-JAN-06                                             
Bates                     24-MAR-07                                             
Kumar                     21-APR-08                                             
Abel                      11-MAY-04                                             
Hutton                    19-MAR-05                                             
Taylor                    24-MAR-06                                             
Livingston                23-APR-06                                             
Johnson                   04-JAN-08                                             

32 rows selected.

SQL> select employee_id , last_name
  2  from employees
  3  where salary >( select avg(salary) from employees
  4  order by salary ;
where salary >( select avg(salary) from employees
                *
ERROR at line 3:
ORA-00921: unexpected end of SQL command 


SQL> select employee_id , last_name
  2  from employees
  3  where salary >( select avg(salary) from employees)
  4  order by salary ;

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        203 Mavris                                                              
        123 Vollman                                                             
        165 Lee                                                                 
        113 Popp                                                                
        155 Tuvault                                                             
        161 Sewall                                                              
        178 Grant                                                               
        164 Marvins                                                             
        172 Bates                                                               
        171 Smith                                                               
        154 Cambrault                                                           

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        160 Doran                                                               
        111 Sciarra                                                             
        112 Urman                                                               
        122 Kaufling                                                            
        120 Weiss                                                               
        159 Smith                                                               
        153 Olsen                                                               
        121 Fripp                                                               
        110 Chen                                                                
        206 Gietz                                                               
        177 Livingston                                                          

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        176 Taylor                                                              
        175 Hutton                                                              
        158 McEwen                                                              
        152 Hall                                                                
        109 Faviet                                                              
        103 Hunold                                                              
        157 Sully                                                               
        151 Bernstein                                                           
        163 Greene                                                              
        170 Fox                                                                 
        156 King                                                                

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        150 Tucker                                                              
        204 Baer                                                                
        169 Bloom                                                               
        149 Zlotkey                                                             
        162 Vishney                                                             
        174 Abel                                                                
        148 Cambrault                                                           
        114 Raphaely                                                            
        168 Ozer                                                                
        147 Errazuriz                                                           
        108 Greenberg                                                           

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        205 Higgins                                                             
        201 Hartstein                                                           
        146 Partners                                                            
        145 Russell                                                             
        102 De Haan                                                             
        101 Kochhar                                                             
        100 King                                                                

51 rows selected.

SQL> select employee_id, last_name
  2  from employees
  3  where department_id in
  4  (select department_id from employees where last_name like '%u');

no rows selected

SQL> select employee_id, last_name
  2  from employees
  3  where department_id in
  4  (select department_id from employees where last_name like '%u%');

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        107 Lorentz                                                             
        106 Pataballa                                                           
        105 Austin                                                              
        104 Ernst                                                               
        103 Hunold                                                              
        199 Grant                                                               
        198 OConnell                                                            
        197 Feeney                                                              
        196 Walsh                                                               
        195 Jones                                                               
        194 McCain                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        193 Everett                                                             
        192 Bell                                                                
        191 Perkins                                                             
        190 Gates                                                               
        189 Dilly                                                               
        188 Chung                                                               
        187 Cabrio                                                              
        186 Dellinger                                                           
        185 Bull                                                                
        184 Sarchand                                                            
        183 Geoni                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        182 Sullivan                                                            
        181 Fleaur                                                              
        180 Taylor                                                              
        144 Vargas                                                              
        143 Matos                                                               
        142 Davies                                                              
        141 Rajs                                                                
        140 Patel                                                               
        139 Seo                                                                 
        138 Stiles                                                              
        137 Ladwig                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        136 Philtanker                                                          
        135 Gee                                                                 
        134 Rogers                                                              
        133 Mallin                                                              
        132 Olson                                                               
        131 Marlow                                                              
        130 Atkinson                                                            
        129 Bissot                                                              
        128 Markle                                                              
        127 Landry                                                              
        126 Mikkilineni                                                         

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        125 Nayer                                                               
        124 Mourgos                                                             
        123 Vollman                                                             
        122 Kaufling                                                            
        121 Fripp                                                               
        120 Weiss                                                               
        179 Johnson                                                             
        177 Livingston                                                          
        176 Taylor                                                              
        175 Hutton                                                              
        174 Abel                                                                

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        173 Kumar                                                               
        172 Bates                                                               
        171 Smith                                                               
        170 Fox                                                                 
        169 Bloom                                                               
        168 Ozer                                                                
        167 Banda                                                               
        166 Ande                                                                
        165 Lee                                                                 
        164 Marvins                                                             
        163 Greene                                                              

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        162 Vishney                                                             
        161 Sewall                                                              
        160 Doran                                                               
        159 Smith                                                               
        158 McEwen                                                              
        157 Sully                                                               
        156 King                                                                
        155 Tuvault                                                             
        154 Cambrault                                                           
        153 Olsen                                                               
        152 Hall                                                                

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        151 Bernstein                                                           
        150 Tucker                                                              
        149 Zlotkey                                                             
        148 Cambrault                                                           
        147 Errazuriz                                                           
        146 Partners                                                            
        145 Russell                                                             
        119 Colmenares                                                          
        118 Himuro                                                              
        117 Tobias                                                              
        116 Baida                                                               

EMPLOYEE_ID LAST_NAME                                                           
----------- -------------------------                                           
        115 Khoo                                                                
        114 Raphaely                                                            

90 rows selected.

SQL> select last_name , department_id, job_id
  2  from employees
  3  wehere department_id in (
  4  select department_id from departments d , locations l
  5  where d.location_id = l.location_id and location_id=1700);
wehere department_id in (
       *
ERROR at line 3:
ORA-00933: SQL command not properly ended 


SQL> select last_name , department_id, job_id
  2  from employees
  3  wehere department_id in (
  4  select department_id from departments d , locations l
  5  where d.location_id = l.location_id and l.location_id=1700);
wehere department_id in (
       *
ERROR at line 3:
ORA-00933: SQL command not properly ended 


SQL> select last_name , department_id, job_id
  2  from employees
  3  where department_id in (
  4  select department_id from departments d , locations l
  5  where d.location_id = l.location_id and l.location_id=1700);

LAST_NAME                 DEPARTMENT_ID JOB_ID                                  
------------------------- ------------- ----------                              
King                                 90 AD_PRES                                 
Kochhar                              90 AD_VP                                   
De Haan                              90 AD_VP                                   
Greenberg                           100 FI_MGR                                  
Faviet                              100 FI_ACCOUNT                              
Chen                                100 FI_ACCOUNT                              
Sciarra                             100 FI_ACCOUNT                              
Urman                               100 FI_ACCOUNT                              
Popp                                100 FI_ACCOUNT                              
Raphaely                             30 PU_MAN                                  
Khoo                                 30 PU_CLERK                                

LAST_NAME                 DEPARTMENT_ID JOB_ID                                  
------------------------- ------------- ----------                              
Baida                                30 PU_CLERK                                
Tobias                               30 PU_CLERK                                
Himuro                               30 PU_CLERK                                
Colmenares                           30 PU_CLERK                                
Whalen                               10 AD_ASST                                 
Higgins                             110 AC_MGR                                  
Gietz                               110 AC_ACCOUNT                              

18 rows selected.

SQL> select department_id, last_name, job_id
  2  from employees
  3  where department_id in
  4  (select department_id from employees where department_name ='Executive');
(select department_id from employees where department_name ='Executive')
                                           *
ERROR at line 4:
ORA-00904: "DEPARTMENT_NAME": invalid identifier 


SQL> select department_id, last_name, job_id
  2  from employees
  3  where department_id in
  4  (select department_id from departments where department_name ='Executive');

DEPARTMENT_ID LAST_NAME                 JOB_ID                                  
------------- ------------------------- ----------                              
           90 King                      AD_PRES                                 
           90 Kochhar                   AD_VP                                   
           90 De Haan                   AD_VP                                   

SQL> select employee_id , last_name , salary
  2  from employees
  3  where salary > (select avg(salary) from employees)
  4  and department_id in
  5  (select department_id from employees where last_name like'%u%');

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        103 Hunold                          9000                                
        123 Vollman                         6500                                
        122 Kaufling                        7900                                
        121 Fripp                           8200                                
        120 Weiss                           8000                                
        177 Livingston                      8400                                
        176 Taylor                          8600                                
        175 Hutton                          8800                                
        174 Abel                           11000                                
        172 Bates                           7300                                
        171 Smith                           7400                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        170 Fox                             9600                                
        169 Bloom                          10000                                
        168 Ozer                           11500                                
        165 Lee                             6800                                
        164 Marvins                         7200                                
        163 Greene                          9500                                
        162 Vishney                        10500                                
        161 Sewall                          7000                                
        160 Doran                           7500                                
        159 Smith                           8000                                
        158 McEwen                          9000                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        157 Sully                           9500                                
        156 King                           10000                                
        155 Tuvault                         7000                                
        154 Cambrault                       7500                                
        153 Olsen                           8000                                
        152 Hall                            9000                                
        151 Bernstein                       9500                                
        150 Tucker                         10000                                
        149 Zlotkey                        10500                                
        148 Cambrault                      11000                                
        147 Errazuriz                      12000                                

EMPLOYEE_ID LAST_NAME                     SALARY                                
----------- ------------------------- ----------                                
        146 Partners                       13500                                
        145 Russell                        14000                                
        114 Raphaely                       11000                                

36 rows selected.

SQL> spool off
